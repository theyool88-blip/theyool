# 게시판 기능 상세 명세

성공사례와 칼럼을 **완전한 게시판 형태**로 구현하기 위한 상세 기능 명세서

---

## 공통 게시판 기능

### 1. 목록 페이지 기능

#### 필터링
- **카테고리 필터**: 특정 카테고리만 보기
- **태그 필터** (칼럼만): 여러 태그 동시 선택 가능
- **상태 필터** (관리자): 공개/비공개 구분

#### 검색
- **검색 대상**: 제목, 본문 내용
- **검색 방식**: PostgreSQL Full Text Search
- **실시간 검색**: 입력하면서 결과 갱신 (선택)
- **검색어 하이라이트**: 검색 결과에서 키워드 강조

#### 정렬
- **최신순**: created_at DESC (기본)
- **조회수순**: views DESC
- **발행일순**: published_at DESC (칼럼만)

#### 페이지네이션
- **페이지당 항목 수**:
  - 성공사례: 9개 (3x3 그리드)
  - 칼럼: 12개 (4x3 그리드) 또는 10개 (리스트)
- **페이지네이션 UI**: 1 2 3 ... 10 형태
- **현재 페이지 표시**: 강조 표시
- **이전/다음 버튼**: 화살표 아이콘

#### 레이아웃
- **그리드 뷰**: 카드 형태로 썸네일 포함
- **리스트 뷰** (선택): 제목, 날짜, 조회수 테이블 형태
- **빈 상태**: 결과 없을 때 안내 메시지

---

## 성공사례 게시판 특화 기능

### 목록 페이지 (/cases)

#### 카테고리 필터
- 전체 보기
- 위자료 (alimony)
- 재산분할 (property)
- 양육권 (custody)
- 상간사건 (adultery)

#### 카드 정보 표시
- 배지 (Case 01, Case 02...)
- 카테고리 라벨
- 제목
- 결과 요약 (한 줄)
- 조회수
- 아이콘/이미지

#### URL 구조
```
/cases                           전체 목록
/cases?category=alimony          카테고리 필터
/cases?search=위자료              검색
/cases?sort=views                정렬
/cases?page=2                    페이지
/cases?category=alimony&sort=views&page=2   복합 필터
```

### 상세 페이지 (/cases/[id])

#### 표시 정보
- 배지
- 제목
- 카테고리
- 작성일
- 조회수
- **사건 배경**: 본문
- **전략**: 본문
- **결과**: 본문
- 이미지 (있는 경우)

#### 네비게이션
- 목록으로 돌아가기
- 이전 사례 / 다음 사례
- 같은 카테고리의 관련 사례 3개

#### 조회수 증가
- 페이지 로드 시 자동 증가
- 중복 방지: 세션 또는 쿠키로 24시간 내 중복 제외

---

## 칼럼 게시판 특화 기능

### 목록 페이지 (/blog)

#### 카테고리 예시
- 전체 보기
- 이혼절차 가이드
- 재산분할 정보
- 양육권 정보
- 위자료 정보
- 법률 상식
- 사건 해설

#### 태그 시스템
- 하단에 인기 태그 표시
- 클릭 시 해당 태그 게시물 필터링
- 태그 클라우드 형태 (선택)

#### 추천 칼럼 (Featured)
- 상단에 고정 표시
- 큰 썸네일로 강조
- 최대 3개까지

#### 카드 정보 표시
- 썸네일 이미지
- 제목
- 요약 (excerpt)
- 카테고리
- 태그 (최대 3개)
- 작성일
- 조회수
- 작성자

#### URL 구조
```
/blog                                전체 목록
/blog?category=이혼절차               카테고리
/blog?tags=위자료,재산분할             태그 (여러 개 가능)
/blog?search=양육권                   검색
/blog?sort=views                     정렬
/blog?featured=true                  추천글만
/blog/my-first-post                  상세 (slug)
```

### 상세 페이지 (/blog/[slug])

#### 표시 정보
- 제목
- 카테고리
- 태그들
- 작성자
- 작성일 / 수정일
- 조회수
- 썸네일 이미지 (선택)
- **본문 콘텐츠** (Rich Text)

#### 네비게이션
- 목록으로 돌아가기
- 이전 글 / 다음 글
- 관련 칼럼 3개 (같은 카테고리 또는 태그)

#### 공유 기능
- 카카오톡 공유
- 페이스북 공유
- 링크 복사
- SNS 공유 시 Open Graph 메타 태그 활용

#### 조회수 증가
- 페이지 로드 시 자동 증가
- 중복 방지: 쿠키로 1시간 내 중복 제외

---

## 관리자 게시판 관리 기능

### 목록 관리 (/admin/cases, /admin/blog)

#### 테이블 컬럼
- 체크박스 (일괄 삭제용)
- 썸네일 (작은 크기)
- 제목
- 카테고리
- 상태 (공개/비공개)
- 조회수
- 작성일
- 작업 (수정/삭제 버튼)

#### 일괄 작업
- 선택 항목 일괄 삭제
- 선택 항목 공개/비공개 전환

#### 검색/필터
- 제목으로 검색
- 카테고리 필터
- 상태 필터 (공개/비공개/전체)

#### 정렬
- 최신순 (기본)
- 조회수순
- 제목순 (가나다)

#### 빠른 편집
- 행 클릭 시 수정 페이지로 이동
- 상태 토글 버튼 (공개 ↔ 비공개)

### 작성/수정 페이지

#### 공통 필드
- 제목 (필수)
- 카테고리 (선택)
- 내용 (필수)
- 썸네일/이미지 업로드
- 공개/비공개 상태
- 임시저장 버튼
- 미리보기 버튼

#### 성공사례 전용 필드
- 배지 (Case XX)
- 사건 배경
- 전략
- 결과
- 아이콘 선택 (emoji picker)

#### 칼럼 전용 필드
- Slug (자동 생성 또는 수동 입력)
- 요약 (excerpt)
- 태그 입력 (자동완성)
- 추천글 설정
- 발행 예약 (선택)

#### Rich Text Editor (칼럼)
- **에디터 선택**: TipTap (추천) or Quill
- **기능**:
  - 제목 스타일 (H2, H3, H4)
  - 볼드, 이탤릭, 밑줄
  - 글머리 기호, 번호 매기기
  - 링크 삽입
  - 이미지 삽입 (업로드)
  - 인용구
  - 코드 블록 (선택)
  - 테이블 (선택)

#### 유효성 검사
- 제목: 최소 5자, 최대 100자
- 내용: 최소 50자
- Slug: 중복 확인, URL 안전 문자만
- 이미지: 크기 제한 (5MB 이하), 형식 (jpg, png, webp)

#### 자동저장
- 30초마다 임시저장
- 브라우저 새로고침 시 복구 가능

---

## 검색 기능 구현

### PostgreSQL Full Text Search

#### 장점
- 별도 검색 엔진 불필요
- 빠른 검색 속도
- 가중치 설정 (제목 > 본문)

#### 구현 방법
```sql
-- 검색 쿼리 예시
SELECT * FROM cases
WHERE search_vector @@ plainto_tsquery('simple', '위자료')
ORDER BY ts_rank(search_vector, plainto_tsquery('simple', '위자료')) DESC;
```

#### API에서 사용
```typescript
const { data } = await supabase
  .from('cases')
  .select('*')
  .textSearch('search_vector', searchQuery)
  .order('created_at', { ascending: false });
```

---

## 조회수 중복 방지

### 방법 1: 쿠키 사용 (추천)
```typescript
// 서버 측에서 체크
const viewedCookie = cookies().get(`viewed_case_${id}`);
if (!viewedCookie) {
  // 조회수 증가
  await incrementViews(id);
  // 쿠키 설정 (24시간)
  cookies().set(`viewed_case_${id}`, 'true', { maxAge: 86400 });
}
```

### 방법 2: IP 기반 (서버 로그)
```typescript
// 별도 테이블에 IP와 조회 기록 저장
CREATE TABLE view_logs (
  id UUID PRIMARY KEY,
  post_id UUID,
  ip_address TEXT,
  viewed_at TIMESTAMP
);
```

### 방법 3: 세션 기반
- Next.js 세션에 조회한 게시물 ID 저장
- 간단하지만 로그인 사용자에게만 적용 가능

**추천**: 쿠키 방식 (구현 간단, 효과적)

---

## UI/UX 고려사항

### 로딩 상태
- Skeleton UI (목록 로딩 중)
- 스피너 (상세 페이지 로딩 중)
- 페이지 전환 시 부드러운 애니메이션

### 에러 처리
- 404 페이지 (게시물 없음)
- 검색 결과 없음 안내
- 네트워크 에러 재시도

### 모바일 최적화
- 터치 친화적인 버튼 크기
- 스와이프 제스처 (이전/다음 글)
- 모바일에서는 리스트 뷰 권장

### 접근성
- 키보드 네비게이션
- 스크린 리더 지원
- Alt 텍스트 (이미지)
- ARIA 레이블

---

## 성능 최적화

### 데이터베이스
- 인덱스 활용 (category, published, views, created_at)
- 페이지네이션 쿼리 최적화
- 조회수 증가는 비동기 처리

### 이미지
- Next.js Image 컴포넌트 사용
- Lazy loading
- WebP 형식 변환
- 썸네일 자동 생성

### 캐싱
- ISR (Incremental Static Regeneration) 활용
- 목록 페이지 캐싱 (revalidate: 60초)
- 상세 페이지 캐싱 (on-demand revalidation)

---

## 구현 우선순위

### Phase 1: 기본 게시판
1. 목록 조회 (페이지네이션)
2. 상세 조회
3. 검색 기능
4. 카테고리 필터

### Phase 2: 고급 기능
1. 정렬 옵션
2. 조회수 카운팅
3. 관련 게시물 추천
4. 이전/다음 글

### Phase 3: 추가 기능
1. 태그 시스템 (칼럼)
2. 공유 기능 (칼럼)
3. 추천글 기능 (칼럼)
4. 전문 검색 개선

---

**작성일**: 2025-11-05
